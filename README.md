# RentReportGenerator

Скрипт для анализа арендных платежей на основе банковской выписки.

## Описание

Данный проект предназначен для генерации отчета по арендным платежам, сверяя данные из банковской выписки и списка арендаторов. Позволяет выявить фактически оплаченные суммы или найти похожие платежи с настраиваемой разницей.

**Важно:**

* Поддерживается работа только с определённым форматом Excel-файлов (указанным в параметрах)
* Логика сопоставления платежей основана на настраиваемом пороге `max_different`, что может приводить к ложным совпадениям или пропускам
* Встроенная отправка email использует фиксированные настройки SMTP, которые непригодны для использования на проде
* Логика сопоставления платежей использует жёсткую фильтрацию по сумме, но учитывает в формате оплаты только даты, начиная от первоначальной даты

Установка зависимостей:

```bash
pip install -r requirements.txt
```

## Использование

### Запуск из командной строки

```bash
python report_generator.py [--bank_file_path PATH] [--rent_file_path PATH] [--max_different INT] [--report_dir DIR] [--email EMAIL]
```

Пример:

```bash
python report_generator.py --bank_file_path docs/bank_report.xlsx --rent_file_path docs/arenda_list.xlsx --max_different 10 --report_dir reports --email user@example.com
```

### Аргументы

* `bank_file_path` — путь к Excel-файлу банковской выписки (по умолчанию: `docs/bank_report.xlsx`)
* `rent_file_path` — путь к Excel-файлу с данными по аренде (по умолчанию: `docs/arenda_list.xlsx`)
* `max_different` — максимально допустимая разница суммы для определения похожего платежа (по умолчанию: 10)
* `report_dir` — директория для сохранения отчетов (по умолчанию: `reports`)
* `email` — email для отправки отчета (если не указан, отчет сохраняется локально)

## Формат входных файлов

* **Банковская выписка**: ожидается Excel в формате выписки из Сбербанк онлайн
* **Список аренды**: Excel с колонками `Гараж`, `Сумма`, `Первоначальная дата`

Формат и структура входных данных жестко зашиты в код

## Ограничения и замечания

* Обработка дат и сумм чувствительна к формату исходных данных - любые отклонения могут привести к ошибкам
* Отправка email реализована через `mailtrap.io` с пустым паролем — необходимо заменить на реальные SMTP-сервер и данные
